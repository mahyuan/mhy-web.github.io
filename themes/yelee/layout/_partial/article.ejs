<article id="<%= post.layout %>-<%= post.slug %>" class="article article-type-<%= post.layout %>" itemscope itemprop="blogPost">
  <div class="article-inner">
    <% if (theme.fancybox){ %>
      <input type="hidden" class="isFancy" />
    <% } %>
    <% if (post.link || post.title){ %>
      <header class="article-header">
        <%- partial('post/title', {class_name: 'article-title'}) %>
        <div class="article-title-right">
          <% if(theme.leancloud_visitors.enable) { %>
            <div class="post_visits">
              <div id="<%- url_for(post.path) %>" class="leancloud_visitors"
                data-flag-title="<%= post.title %>">
                <span class="post-meta-item-icon">
                  <i class="fa fa-eye" aria-hidden="true"></i>
                </span>
                <span class="post-meta-item-text"><%= __('visit_counter.page') %></span>
                <span class="lean_value_page_pv"><%= post.visitors %></span>
              </div>
            </div>
          <% } %>
          <% if(post.noDate != "true") { %>
            <div class="article-meta">
              <%- partial('post/date', {class_name: 'article-date', date_format: null}) %>
            </div>
          <% } %>
        </div>
      </header>
      <% if (!index){ %>
      <div class="article-info article-info-post">
        <%- partial('post/category') %>
        <%- partial('post/tag') %>
        <div class="clearfix"></div>
      </div>
      <% } %>
    <% } %>
    <div class="article-entry" itemprop="articleBody">
      <% if (index && (post.description || post.excerpt)){ %>
          <% if (post.description){ %>
              <%- post.description %>
          <% } else { %>
              <%- post.excerpt %>
          <% } %>
      <% } else { %>
          <% if (is_page()){ %>
              <%- partial('_partial/page') %>
          <% } %>
        <%- post.content %>
      <% } %>
    </div>
    <% if (index){ %>
    <div class="article-info article-info-index">
      <%if(post.top){%>
        <div class="article-pop-out tagcloud">
          <a class="">置顶</a>
        </div>
      <% } %>
      <%- partial('post/category') %>
      <%- partial('post/tag') %>
      <% if (index && (post.description || post.excerpt)){ %>
        <p class="article-more-link">
          <a href="<%- url_for(post.path) %>#more"><%= __('index.more') %> >></a>
        </p>
      <% } %>
      <div class="clearfix"></div>
    </div>
    <% } %>
  </div>
  <% if (!index){ %>
    <%- partial('post/nav') %>
  <% } %>
</article>
<%- partial('_partial/toc') %>

<% if (!index && theme.share.on && (post.share != false || post.share)){ %>
    <%- partial('post/share') %>
<% } %>

<% if (!index && post.comments){ %>
    <% if (theme.valine.enable) { %>
      <%- partial('comments/valine.ejs', {
        key: post.path,
        title: post.title,
        url: config.url+url_for(post.path)
      }) %>
    <% } else if (theme.duoshuo.on) { %>
      <%- partial('comments/duoshuo', {
          key: post.path,
          title: post.title,
          url: config.url+url_for(post.path),
          }) %>
    <% } else if (theme.livere.on) { %>
      <%- partial('comments/livere', {
          key: post.path,
          title: post.title,
          url: config.url+url_for(post.path),
          }) %>
    <% } else if (theme.youyan.on) { %>
        <%- partial('comments/youyan') %>
    <% } else if (theme.disqus.on) { %>
        <%- partial('comments/disqus', {
            shortname: theme.disqus.shortname
          }) %>
    <% } else if (config.disqus_shortname) { %>
        <%- partial('comments/disqus', {
            shortname: config.disqus_shortname
          }) %>
    <% } else if(theme.gitalk.enable) { %>
          <%- partial('comments/gitalk', {
            shortname: theme.gitalk.shortname
          }) %>
    <% } else if(theme.gitment.enable) { %>
      <%- partial('comments/gitment', {
            shortname: theme.gitment.shortname
          }) %>
    <% } %>
<% } %>

<%- partial('_partial/post-nav-button') %>

<% if (!index) { %>
    <script>
        <% if (post.fancybox === false) { %>
            yiliaConfig.fancybox = false;
        <% } %>
    </script>
<% } %>
